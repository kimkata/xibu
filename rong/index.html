<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="rebots" content="noindex,nofollow"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>排班表</title>
</head>
<body>
    <h3>排班表</h3> 
    <div id = "content"></div>
    <div id = "today"></div>
    <hr>
    
    <h4>未来180天时间表:</h4>
    <div id = "future"></div>
<script>

    function queryURL(url){
        var arr1 = url.split("?");
        if(arr1.length < 2){
            return {};
        }
        // if (typeof arr1[1] == "undefined") {
        //     return {};
        // }
        var params = arr1[1].split("&");
        var obj = {};
        for(var i=0;i<params.length;i++){
            var param = params[i].split("=");
            obj[param[0]] = param[1];
        }   
        return obj;
    }
    var url = window.location.href;
    var obj = queryURL(url);
    console.log(obj)

    //可以修改以下number的值
    var number = decodeURIComponent(obj['number']||1);
    var date = new Date();
    var mseconds = Date.parse(date) + 8*60*60*1000;
    var hour = date.getHours();
    var min = date.getMinutes();
    var n = parseInt(mseconds/(24*60*60*1000))%2;
    console.log("n=",n,",number=",number);
    var workhour_a = "早班 07:30~13:00&nbsp🌤";
    var workhour_b = "晚班 13:00~21:00&nbsp🌙";


    if (n == number) {
        //晚班
        document.querySelector("#content").innerHTML = "<p>班次: <font color='red'>"+ workhour_b +" </font></p>"; 
        if (hour < 13) {
            document.querySelector("#content").innerHTML += "<p>状态: <font color='red'> 13:00以后要去上班</font></p>";  
        } else if (hour>=13 & hour < 21) {
            document.querySelector("#content").innerHTML += "<p>状态: <font color='red'>上班中👣👣</font></p>";            
        } else {
            document.querySelector("#content").innerHTML += "<p>状态: <font color='red'>已经下班😎😃😍</font></p>";  
        }
    } else {
        //早班
        document.querySelector("#content").innerHTML = "<p>班次: <font color='red'>"+ workhour_a +"</font></p>"; 
        if (hour < 8 & min < 30) {
            document.querySelector("#content").innerHTML += "<p>状态: <font color='red'>7:30以后要去上班</font></p>";  
        } else if (hour >= 8 & hour < 13) {
            document.querySelector("#content").innerHTML += "<p>状态: <font color='red'>上班中👣👣</font></p>";            
        } else {
            document.querySelector("#content").innerHTML += "<p>状态:<font color='red'> 已经下班😎😃😍</font></p>";  
        }
    }
    
    for (let delta = 0; delta < 180; delta++) {
        var date_2 = date.setDate(date.getDate()+ 1);
        var dateTime = new Date(date_2);
        if (n == number) {
            //今天上晚班
            if (delta%2 == 0) {
                document.querySelector("#future").innerHTML += "<p><font color='green'>"+ format_date(dateTime)+", "+ workhour_a +"</font></p>";   
            }else{
                document.querySelector("#future").innerHTML += "<p><font color='red'>"+ format_date(dateTime)+", "+ workhour_b +"</font></p>"; 
            }        
        }else{
            //今天上早班
            if (delta%2 == 0) {
                document.querySelector("#future").innerHTML += "<p><font color='green'>"+ format_date(dateTime)+", "+workhour_b+"</font></p>";   
            }else{
                document.querySelector("#future").innerHTML += "<p><font color='red'>"+ format_date(dateTime)+", "+workhour_a+"</font></p>"; 
            }   
        }
        if (dateTime.getDay()==0) {
            document.querySelector("#future").innerHTML += "<hr>"; 
        }             
    }

    function format_date(dateTime){
        let datelist = ['周日','周一','周二','周三','周四','周五','周六',]
        var year = dateTime.getFullYear();
        var month = dateTime.getMonth() + 1;
        var day = dateTime.getDate();
        var weekday = dateTime.getDay();
        return year + "-" + month + "-" + day + ", " + datelist[weekday];
    }



</script>
</body>
</html>

